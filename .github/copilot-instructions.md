# Copilot Instructions for blogogator

## Project Overview
- **blogogator** is a CLI-based RSS feed aggregator and user manager written in Go.
- The app is structured around command handlers, a state object, and a database abstraction layer generated by sqlc.
- Main entrypoint: `main.go` orchestrates config loading, DB connection, and command dispatch.

## Architecture & Data Flow
- **State Management:**
  - The `state` struct holds pointers to the DB queries (`*database.Queries`) and config (`*config.Config`).
- **Command Pattern:**
  - Commands are registered in `main.go` via `comHandlers.register()`.
  - Each command handler receives the current state and a parsed command struct.
  - Middleware (e.g., `middlewareLoggedIn`) wraps handlers for auth-required commands.
- **Database Layer:**
  - All DB access is via `internal/database/` and uses sqlc-generated code.
  - SQL queries are defined in `sql/queries/` and mapped to Go methods in `internal/database/*sql.go`.
- **Config:**
  - User and DB connection info is stored in a JSON config file in the user's home directory (`.gatorconfig.json`).
  - See `internal/config/config.go` for config read/write logic.

## Developer Workflows
- **Build:**
  - Standard Go build: `go build` in the project root.
- **Run:**
  - Usage: `./blogogator <command> [args]`
  - Example: `./blogogator login mark`
- **Database Migrations:**
  - SQL schema and queries live in `sql/schema/` and `sql/queries/`.
  - DB connection string is set in config.
- **sqlc:**
  - Regenerate DB code with `sqlc generate` (requires sqlc installed).
- **Testing:**
  - No explicit test files found; add tests in Go convention if needed.

## Project-Specific Patterns
- **Command Registration:**
  - All commands are registered in `main.go` and implemented in `commands_*.go` files.
- **Error Handling:**
  - Fatal errors use `log.Fatalf` for immediate exit.
- **User Auth:**
  - Current user is tracked in config; some commands require login (see middleware).
- **Feed Fetching:**
  - RSS fetching/parsing logic in `commands_rss.go`.

## Key Files & Directories
- `main.go`: Entrypoint, command registration, state setup
- `commands_*.go`: Command handler implementations
- `internal/config/config.go`: Config file logic
- `internal/database/`: sqlc-generated DB access
- `sql/queries/`: SQL query definitions
- `sql/schema/`: DB schema migrations

## External Dependencies
- [sqlc](https://sqlc.dev/): SQL-to-Go codegen
- [lib/pq](https://github.com/lib/pq): PostgreSQL driver
- [google/uuid](https://github.com/google/uuid): UUID generation

## Example: Adding a Command
1. Implement handler in a new/existing `commands_*.go` file.
2. Register in `main.go` via `comHandlers.register("cmdname", handlerFunc)`.
3. If auth required, wrap with `middlewareLoggedIn`.

---

If any section is unclear or missing, please specify what needs improvement or what workflows/patterns should be documented further.